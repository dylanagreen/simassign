desi_mask:
    # Highz program bits
    - [LBG,         1, "LBG",                              {obsconditions: DARK}]
    - [LAE,         2, "LAE",                              {obsconditions: DARK}]
    - [QSO,         3, "QSO",                              {obsconditions: DARK}]

    # Bits for other targets.
    - [ELG,         4, "dark time ELGs",                   {obsconditions: DARK}]
    - [MWS,         5, "MWS targets",                      {obsconditions: DARK|BRIGHT}]
    - [HID,         6, "High density program targets",     {obsconditions: DARK|BRIGHT}]
    - [LENS,        7, "targets from the lensing program", {obsconditions: DARK}]

priorities:
    desi_mask:
        # Increase priority when we have a zgood.
        LAE: {UNOBS: 3400, MORE_ZGOOD: 3450, DONE: 2, OBS: 1, DONOTOBSERVE: 0}
        LBG: {UNOBS: 3500, MORE_ZGOOD: 3550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}
        QSO: {UNOBS: 3500, MORE_ZGOOD: 3550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}

        # Increase priority when we have a zgood.
        ELG:  {UNOBS: 2500, MORE_ZGOOD: 2550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}
        MWS:  {UNOBS: 1500, MORE_ZGOOD: 1550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}
        HID:  {UNOBS: 1500, MORE_ZGOOD: 1550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}
        LENS: {UNOBS: 2500, MORE_ZGOOD: 2550, DONE: 2, OBS: 1, DONOTOBSERVE: 0}

numobs: # These are in "increments of 15", i.e. 4 = 1 hour of effective time.
    desi_mask:
        # High Z program
        LBG: 6
        LAE: 2
        QSO: 4

        ELG: 1
        MWS: 1
        HID: 1
        LENS: 8

#- qso bits
qso_mask:
    - [BASE,             0, "Regular QSO",      {obsconditions: DARK, numobs_mult: 1}]
    - [QSO_HIZ,          1, "HIGHZ QSO",        {obsconditions: DARK, numobs_mult: 2}]

lbg_mask:
    - [LBG234,             0, "23.4 mag cut",      {obsconditions: DARK, numobs_mult: 1, frac: 90/850}]
    - [LBG238,             1, "23.8 mag cut",      {obsconditions: DARK, numobs_mult: 2, frac: 220/850}]
    - [LBG240,             2, "24.0 mag cut",      {obsconditions: DARK, numobs_mult: 3, frac: 220/850}]
    - [LBG242,             3, "24.2 mag cut",      {obsconditions: DARK, numobs_mult: 4, frac: 320/850}]

obsconditions:
    - [DARK,        0, "Moon is down"]
    - [GRAY,        1, "Moon up; illum fraction<0.6 and (illum*elev)<30 deg"]
    - [BRIGHT,      2, "Moon up and bright"]
    - [BACKUP,      3, "Very bad seeing, high extinction, or bright cloud cover"]
    - [TWILIGHT12,  4, "Between sunset/sunrise and 12 degree twilight"]
    - [TWILIGHT18,  5, "Between 12 and 18 degree twilight"]
    - [DAY,         6, "Daytime calibrations"]
    - [CLOSED,      7, "Nighttime but dome is closed due to rain, wind, dew..."]
    - [APOCALYPSE,  8, "Conditions are so bad that the world is ending anyway"]
    - [IGNORE,      9, "Used to indicate that obsconditions are set by a sub-bit rather than this bit"]
    - [DARK1B,     10, "Moon is down, DESI 1B survey"]
    - [BRIGHT1B,   11, "Moon up and bright, DESI 1B survey"]